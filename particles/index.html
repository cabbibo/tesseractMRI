
<body style="background:#000">
  
  <script src = "/allSiteLib/three.min.js" >                            </script>
  <script src = "/allSiteLib/ConvexGeometry.js" >                       </script>
  
  <script src = "/allSiteLib/OrbitControls.js" >                        </script>
  <script src = "/allSiteLib/leap.js" >                                 </script>
  <script src = "/allSiteLib/stats.min.js" >                            </script>
  <script src = "/allSiteLib/underscore.js" >                           </script>
  <script src = "/allSiteLib/js/AUDIO.js" >                             </script>
  <script src = "/allSiteLib/math.js" >                                 </script>

  
  <script src = "../lib/gl-matrix-min.js" >                             </script>
  <script src = "../lib/2d.js">                                         </script>
  <script src = "../lib/3d.js">                                         </script>
  <script src = "../lib/4d.js">                                         </script>
  <script src = "../lib/loop.js">                                       </script>
  <script src = "../lib/audio.js">                                      </script>
  <script src = "../lib/scene.js">                                      </script>
  
  <script src = "../lib/App.js">                                        </script>

  <script src = "perlin.js">                                            </script>
  <script src = "ParticleEmitter.js">                                   </script>
  
  <div id="container" style="position:absolute;top:0;left:0"></div>


  <script>

    //masterGain.gain.value = 0;

    var app  = new App();

    app.ui2d = new Controller2D();
    app.ui3d = new Controller3D();

    app.ui2d.particleEmitter = new ParticleEmitter();
    console.log( app.ui2d.renderer.flatScene );
    app.ui2d.renderer.flatScene.add( app.ui2d.particleEmitter );

    app.ui3d.particleEmitter = new ParticleEmitter();

    app.update = function(){

      drawIntersections();
      checkForHitCorners();
      
      //tesseractScene.rotation.y += .01;
      //particleScene.rotation.y += .01;

      app.ui2d.update();
      app.ui3d.update();

    }

    app.cornerHit = function(i){

      // Gets a position based 
      var p = getCornerPosition( hitCorners[i][0] );

      //
      console.log( corners[hitCorners[i][0]] );

      cornerEmitter.position = convertToThree( p[0] );
      cornerEmitter.scene.position = cornerEmitter.position;

      if( hitCorners[i][1] == "life" ){
        cornerEmitter.birth();
      }else if( hitCorners[i][1] == "death" ){
        cornerEmitter.death();
      }else if( hitCorners[i][1] == "sleep" ){
        cornerEmitter.sleep();
      }else{
        console.log('WTF');
      }

      app.ui2d.checkCornerHit( corners[hitCorners[i][0]] , hitCorners[i][1] );

      //cornerEmitter.position.x = 100000;

    }

  </script>

</body>

  
